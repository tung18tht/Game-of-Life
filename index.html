<!DOCTYPE html>

<html>

<head>
    <title>Conway's Game of Life</title>

    <style>
        body {
            background-color: black;
        }

        #universe {
            display: grid;
        }

        #universe div {
            border: 1px solid #222;
        }

        .live {
            background-color: white;
        }

        .dead {
            background-color: black;
        }
    </style>
</head>

<body>
    <div>
        <button onclick="run()">Run</button>
        <button onclick="pause()">Pause</button>
        <button onclick="step()">Step</button>
        <button onclick="reset()">Reset</button>
    </div>

    <div id="universe"></div>


    <script>
        let width = 70
        let height = 30
        let cellSize = 20

        let loopID = -1
        let universe = createEmptyUniverse()

        const UNIVERSE_DIV = document.getElementById("universe")
        UNIVERSE_DIV.style.gridTemplateColumns = "repeat(" + width + ", " + cellSize + "px)"

        const CELL_DIVS = createEmpty2DArray(width, height)

        for (let i = 0; i < height; i++) {
            for (let j = 0; j < width; j++) {
                const cellDiv = document.createElement("div")
                cellDiv.style.width = cellSize + "px"
                cellDiv.style.height = cellSize + "px"

                cellDiv.className = "dead"

                cellDiv.addEventListener("click", () => flip(i, j))

                UNIVERSE_DIV.appendChild(cellDiv)
                CELL_DIVS[i][j] = cellDiv
            }
        }


        function run() {
            if (loopID == -1) {
                loopID = setInterval(step, 500)
            }
        }

        function pause() {
            if (loopID != -1) {
                clearInterval(loopID)
                loopID = -1
            }
        }

        function step() {
            for (let i = 0; i < height; i++) {
                for (let j = 0; j < width; j++) {
                    flip(i, j)
                }
            }
        }

        function reset() {
            pause()
            universe = createEmptyUniverse()
            for (let i = 0; i < height; i++) {
                for (let j = 0; j < width; j++) {
                    updateCellDiv(i, j)
                }
            }
        }

        function flip(i, j) {
            universe[i][j] = !universe[i][j]
            updateCellDiv(i, j)
        }

        function updateCellDiv(i, j) {
            CELL_DIVS[i][j].className = universe[i][j] ? "live" : "dead"
        }

        function createEmptyUniverse() {
            const emptyUniverse = createEmpty2DArray(width, height)
            emptyUniverse.forEach(row => row.fill(false))

            return emptyUniverse
        }

        function createEmpty2DArray(width, height) {
            const emptyArray = new Array(height)
            for (let i = 0; i < height; i++) {
                emptyArray[i] = new Array(width)
            }

            return emptyArray
        }
    </script>
</body>

</html>
